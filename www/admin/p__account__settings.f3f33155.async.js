(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{KWSo:function(O,h,t){O.exports={main:"main___2yGev",leftMenu:"leftMenu___179-W",right:"right___2jdGg",title:"title___3cGwa"}},O4pj:function(O,h,t){"use strict";t.r(h);var C=t("fWQN"),p=t("mtLc"),P=t("yKVA"),j=t("879j"),X=t("lUTK"),N=t("BvKs"),D=t("q1tI"),e=t.n(D),i=t("9kvl"),v=t("FRQA"),B=t("y8nQ"),d=t("Vl3Y"),g=t("5NDa"),u=t("5rEg"),I=t("k1fw"),H=t("DZo9"),V=t("8z0m"),Y=t("+L6B"),x=t("2/Rp"),J=t("miYZ"),w=t("tsqr"),G=t("OaEy"),Q=t("2fM7"),k=t("z7Xi"),q=t("YHME"),F=t.n(q),ee=t("kRQd"),Z=Q.a.Option,te=function(m){var l=m.avatar,n=m.dispatch,a=m.id;return e.a.createElement(e.a.Fragment,null,e.a.createElement("div",{className:F.a.avatar_title},e.a.createElement(i.a,{id:"accountandsettings.basic.avatar",defaultMessage:"Avatar"})),e.a.createElement("div",{className:F.a.avatar},e.a.createElement("img",{src:l,alt:"avatar"})),e.a.createElement(V.a,{action:"/api/v1/upload",showUploadList:!1,accept:"image/png, image/jpeg, image/gif",beforeUpload:function(r){return r.type==="image/png"||r.type==="image/jpeg"||r.type==="image/gif"},onChange:function(r){var s=r.file;s.status==="done"&&s.response&&s.response.message==="\u6210\u529F"&&n&&n({type:"accountAndsettings/updateAvatar",payload:{id:a,avatar:s.response.data.path},callback:function(c){c.message==="\u4FEE\u6539\u6210\u529F"?(w.default.success(c.message),window.location.reload()):w.default.error(c.message||"\u4FEE\u6539\u5931\u8D25")}})},headers:{Authorization:ee.a.get()||""}},e.a.createElement("div",{className:F.a.button_view},e.a.createElement(x.a,null,e.a.createElement(k.a,null),e.a.createElement(i.a,{id:"accountandsettings.basic.change-avatar",defaultMessage:"Change avatar"})))))},ae=function(y){Object(P.a)(l,y);var m=Object(j.a)(l);function l(){var n;Object(C.a)(this,l);for(var a=arguments.length,f=new Array(a),r=0;r<a;r++)f[r]=arguments[r];return n=m.call.apply(m,[this].concat(f)),n.formRef=e.a.createRef(),n.getData=function(){var s=n.props.dispatch;s&&s({type:"accountAndsettings/fetchCurrent",callback:function(c){c.message==="\u67E5\u8BE2\u6210\u529F"&&n.formRef.current.setFieldsValue(c.data.user)}})},n.view=void 0,n.getViewDom=function(s){n.view=s},n.handleFinish=function(s){var b=n.props,c=b.dispatch,U=b.currentUser,W=[];U.user&&U.user.roles.map(function(z){return W.push(z.id),null}),c&&c({type:"accountAndsettings/updateAccount",payload:Object(I.a)(Object(I.a)({},U.user),{},{roleIds:W},s),callback:function(K){K.code===100030&&K.message==="\u4FEE\u6539\u6210\u529F"?(w.default.success(K.message),n.getData()):w.default.error(K.message||"\u4FEE\u6539\u5931\u8D25")}})},n}return Object(p.a)(l,[{key:"componentDidMount",value:function(){this.getData()}},{key:"getAvatarURL",value:function(){var a=this.props.currentUser;return a.user&&a.user.avatar?a.user.avatar:""}},{key:"render",value:function(){var a=this.props,f=a.updateLoading,r=a.dispatch,s=a.currentUser;return e.a.createElement("div",{className:F.a.baseView,ref:this.getViewDom},e.a.createElement("div",{className:F.a.left},e.a.createElement(d.a,{layout:"vertical",ref:this.formRef,onFinish:this.handleFinish},e.a.createElement(d.a.Item,{name:"nickName",label:"\u7528\u6237\u6635\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0"}]},e.a.createElement(u.a,null)),e.a.createElement(d.a.Item,{name:"mobile",label:"\u624B\u673A\u53F7\u7801",rules:[{required:!1,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801"}]},e.a.createElement(u.a,null)),e.a.createElement(d.a.Item,{name:"email",label:"\u90AE\u7BB1",rules:[{required:!1,message:"\u8BF7\u8F93\u5165\u90AE\u7BB1"}]},e.a.createElement(u.a,null)),e.a.createElement(d.a.Item,{name:"sex",label:"\u6027\u522B",rules:[{required:!1,message:"\u8BF7\u9009\u62E9\u6027\u522B"}]},e.a.createElement(Q.a,{style:{maxWidth:220}},e.a.createElement(Z,{value:"0"},"\u7537"),e.a.createElement(Z,{value:"1"},"\u5973"))),e.a.createElement(d.a.Item,null,e.a.createElement(x.a,{htmlType:"submit",type:"primary",loading:f},e.a.createElement(i.a,{id:"accountandsettings.basic.update",defaultMessage:"Update Information"}))))),e.a.createElement("div",{className:F.a.right},e.a.createElement(te,{avatar:this.getAvatarURL(),dispatch:r,id:s.user&&s.user.id||""})))}}]),l}(D.Component),re=Object(i.b)(function(y){var m=y.accountAndsettings,l=y.loading;return{currentUser:m.currentUser,loadingFetch:l.effects["accountAndsettings/fetchCurrent"],updateLoading:l.effects["accountAndsettings/updateAccount"]}})(ae),ye=t("Q9mQ"),se=t("diRs"),Oe=t("MXD1"),ne=t("CFYs"),$=t("tJVT"),le=t("rXhD"),A=t.n(le),L=d.a.Item,Pe=Q.a.Option,be=u.a.Group,ie={ok:e.a.createElement("div",{className:A.a.success},e.a.createElement(i.a,{id:"userandregister.strength.strong"})),pass:e.a.createElement("div",{className:A.a.warning},e.a.createElement(i.a,{id:"userandregister.strength.medium"})),poor:e.a.createElement("div",{className:A.a.error},e.a.createElement(i.a,{id:"userandregister.strength.short"}))},oe={ok:"success",pass:"normal",poor:"exception"},ce=function(m){var l=m.submitting,n=m.dispatch,a=Object(D.useState)(!1),f=Object($.a)(a,2),r=f[0],s=f[1],b=Object(D.useState)(!1),c=Object($.a)(b,2),U=c[0],W=c[1],z=!1,K=d.a.useForm(),ge=Object($.a)(K,1),R=ge[0],_=function(){var o=R.getFieldValue("newPassword");return o&&o.length>9?"ok":o&&o.length>5?"pass":"poor"},fe=function(o){n({type:"accountAndsettings/changePwd",payload:Object(I.a)({},o),callback:function(M){M.message==="\u4FEE\u6539\u6210\u529F"?(w.default.success("\u4FEE\u6539\u6210\u529F\uFF0C\u8BF7\u4F7F\u7528\u65B0\u5BC6\u7801\u91CD\u65B0\u767B\u5F55\uFF01"),i.d.replace("/user/login")):w.default.error(M.message||"\u4FEE\u6539\u5931\u8D25")}})},pe=function(o,E){var M=Promise;return E&&E!==R.getFieldValue("newPassword")?M.reject(Object(i.c)({id:"userandregister.password.twice"})):M.resolve()},Ee=function(o,E){var M=Promise;return E?(r||s(!!E),W(!U),E.length<6?M.reject(""):(E&&z&&R.validateFields(["confirm"]),M.resolve())):(s(!!E),M.reject(Object(i.c)({id:"userandregister.password.required"})))},he=function(){var o=R.getFieldValue("newPassword"),E=_();return o&&o.length?e.a.createElement("div",{className:A.a["progress-".concat(E)]},e.a.createElement(ne.a,{status:oe[E],className:A.a.progress,strokeWidth:6,percent:o.length*10>100?100:o.length*10,showInfo:!1})):null};return e.a.createElement("div",{className:A.a.main},e.a.createElement(d.a,{form:R,name:"UserRegister",onFinish:fe},e.a.createElement(L,{name:"password",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u65E7\u5BC6\u7801"}]},e.a.createElement(u.a,{size:"large",placeholder:"\u65E7\u5BC6\u7801"})),e.a.createElement(se.a,{getPopupContainer:function(o){return o&&o.parentNode?o.parentNode:o},content:r&&e.a.createElement("div",{style:{padding:"4px 0"}},ie[_()],he(),e.a.createElement("div",{style:{marginTop:10}},e.a.createElement(i.a,{id:"userandregister.strength.msg"}))),overlayStyle:{width:240},placement:"right",visible:r},e.a.createElement(L,{name:"newPassword",className:R.getFieldValue("newPassword")&&R.getFieldValue("newPassword").length>0&&A.a.password,rules:[{validator:Ee}]},e.a.createElement(u.a,{size:"large",type:"password",placeholder:"\u65B0\u5BC6\u7801"}))),e.a.createElement(L,{name:"confirm",rules:[{required:!0,message:Object(i.c)({id:"userandregister.confirm-password.required"})},{validator:pe}]},e.a.createElement(u.a,{size:"large",type:"password",placeholder:Object(i.c)({id:"userandregister.confirm-password.placeholder"})})),e.a.createElement(L,null,e.a.createElement(x.a,{size:"large",loading:l,className:A.a.submit,type:"primary",htmlType:"submit"},"\u786E\u5B9A\u4FEE\u6539"))))},ue=Object(i.b)(function(y){var m=y.accountAndsettings,l=y.loading;return{currentUser:m.currentUser,submitting:l.effects["accountAndsettings/changePwd"]}})(ce),de=t("KWSo"),T=t.n(de),me=N.a.Item,ve=function(y){Object(P.a)(l,y);var m=Object(j.a)(l);function l(n){var a;Object(C.a)(this,l),a=m.call(this,n),a.main=void 0,a.getMenu=function(){var r=a.state.menuMap;return Object.keys(r).map(function(s){return e.a.createElement(me,{key:s},r[s])})},a.getRightTitle=function(){var r=a.state,s=r.selectKey,b=r.menuMap;return b[s]},a.selectKey=function(r){a.setState({selectKey:r})},a.renderChildren=function(){var r=a.state.selectKey;switch(r){case"base":return e.a.createElement(re,null);case"security":return e.a.createElement(ue,null);default:break}return null};var f={base:e.a.createElement(i.a,{id:"accountandsettings.menuMap.basic",defaultMessage:"Basic Settings"}),security:"\u4FEE\u6539\u5BC6\u7801"};return a.state={mode:"inline",menuMap:f,selectKey:"base"},a}return Object(p.a)(l,[{key:"render",value:function(){var a=this,f=this.state,r=f.mode,s=f.selectKey;return e.a.createElement(v.a,null,e.a.createElement("div",{className:T.a.main,ref:function(c){c&&(a.main=c)}},e.a.createElement("div",{className:T.a.leftMenu},e.a.createElement(N.a,{mode:r,selectedKeys:[s],onClick:function(c){var U=c.key;return a.selectKey(U)}},this.getMenu())),e.a.createElement("div",{className:T.a.right},e.a.createElement("div",{className:T.a.title},this.getRightTitle()),this.renderChildren())))}}]),l}(D.Component),Me=h.default=ve},Q9mQ:function(O,h,t){"use strict";var C=t("cIOH"),p=t.n(C),P=t("UADf"),j=t.n(P)},UADf:function(O,h,t){},YHME:function(O,h,t){O.exports={baseView:"baseView___3sRG3",left:"left___GavW0",right:"right___3-EXe",avatar_title:"avatar_title___13ztg",avatar:"avatar___1GisI",button_view:"button_view___o9apF"}},bogI:function(O,h,t){"use strict";t.d(h,"a",function(){return C});var C=function(P){if(!P)return null;var j=typeof P=="function";return j?P():P}},diRs:function(O,h,t){"use strict";var C=t("wx14"),p=t("q1tI"),P=t.n(p),j=t("3S7+"),X=t("H84U"),N=t("bogI"),D=t("EXcs"),e=function(v,B){var d={};for(var g in v)Object.prototype.hasOwnProperty.call(v,g)&&B.indexOf(g)<0&&(d[g]=v[g]);if(v!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,g=Object.getOwnPropertySymbols(v);u<g.length;u++)B.indexOf(g[u])<0&&Object.prototype.propertyIsEnumerable.call(v,g[u])&&(d[g[u]]=v[g[u]]);return d},i=p.forwardRef(function(v,B){var d=v.prefixCls,g=v.title,u=v.content,I=e(v,["prefixCls","title","content"]),H=p.useContext(X.b),V=H.getPrefixCls,Y=function(G){return p.createElement(p.Fragment,null,g&&p.createElement("div",{className:"".concat(G,"-title")},Object(N.a)(g)),p.createElement("div",{className:"".concat(G,"-inner-content")},Object(N.a)(u)))},x=V("popover",d),J=V();return p.createElement(j.a,Object(C.a)({},I,{prefixCls:x,ref:B,overlay:Y(x),transitionName:Object(D.b)(J,"zoom-big",I.transitionName)}))});i.displayName="Popover",i.defaultProps={placement:"top",trigger:"hover",mouseEnterDelay:.1,mouseLeaveDelay:.1,overlayStyle:{}},h.a=i},rXhD:function(O,h,t){O.exports={main:"main___2AtMi",password:"password___1zZSu",getCaptcha:"getCaptcha___1RIzu",submit:"submit___3eLvx",login:"login___3PyV6",success:"success___xzVdH",warning:"warning___1C0WC",error:"error___2wCUM","progress-pass":"progress-pass___2M4Q8",progress:"progress___2bwcK"}}}]);
